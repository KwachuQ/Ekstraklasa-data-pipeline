{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-11-04T12:30:05.118493Z", "invocation_id": "a5fd90f6-a134-4e7d-85d1-4ae12bdd5a8c", "invocation_started_at": "2025-11-04T12:30:02.249828Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-04T12:30:04.494516Z", "completed_at": "2025-11-04T12:30:04.522307Z"}, {"name": "execute", "started_at": "2025-11-04T12:30:04.545784Z", "completed_at": "2025-11-04T12:30:04.745478Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.26804256439208984, "adapter_response": {"_message": "SELECT 385", "code": "SELECT", "rows_affected": 385}, "message": "SELECT 385", "failures": null, "unique_id": "model.sofascore_pipeline.mart_head_to_head", "compiled": true, "compiled_code": "\n\nwith h2h_matches as (\n    select\n        fm.match_id,\n        fm.match_date,\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        fm.home_team_id,\n        fm.home_team_name,\n        fm.away_team_id,\n        fm.away_team_name,\n        fm.home_score,\n        fm.away_score,\n        fm.winner_code,\n        least(fm.home_team_id, fm.away_team_id) as team_id_1,\n        greatest(fm.home_team_id, fm.away_team_id) as team_id_2\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    where fm.status_type = 'finished'\n),\nranked_matches as (\n    select\n        *,\n        row_number() over (partition by team_id_1, team_id_2 order by match_date desc) as match_rank\n    from h2h_matches\n),\nlast_5_matches as (\n    select\n        team_id_1,\n        team_id_2,\n        string_agg(\n            case \n                when (home_team_id = team_id_1 and winner_code = 1) or (away_team_id = team_id_1 and winner_code = 2) then '1'\n                when winner_code = 3 then 'X'\n                else '2'\n            end || ' (' || \n            case when home_team_id = team_id_1 then home_score || '-' || away_score else away_score || '-' || home_score end ||\n            ')',\n            ' | ' order by match_date desc\n        ) as last_5_results\n    from ranked_matches\n    where match_rank <= 5\n    group by team_id_1, team_id_2\n)\nselect\n    h.team_id_1,\n    h.team_id_2,\n    max(case when h.home_team_id = h.team_id_1 then h.home_team_name else h.away_team_name end) as team_1_name,\n    max(case when h.home_team_id = h.team_id_2 then h.home_team_name else h.away_team_name end) as team_2_name,\n    count(*) as total_matches,\n    sum(case when (h.home_team_id = h.team_id_1 and h.winner_code = 1) or (h.away_team_id = h.team_id_1 and h.winner_code = 2) then 1 else 0 end) as team_1_wins,\n    sum(case when h.winner_code = 3 then 1 else 0 end) as draws,\n    sum(case when (h.home_team_id = h.team_id_2 and h.winner_code = 1) or (h.away_team_id = h.team_id_2 and h.winner_code = 2) then 1 else 0 end) as team_2_wins,\n    sum(case when h.home_team_id = h.team_id_1 then h.home_score else h.away_score end) as team_1_goals,\n    sum(case when h.home_team_id = h.team_id_2 then h.home_score else h.away_score end) as team_2_goals,\n    round(avg(case when h.home_team_id = h.team_id_1 then h.home_score else h.away_score end), 2) as team_1_avg_goals,\n    round(avg(case when h.home_team_id = h.team_id_2 then h.home_score else h.away_score end), 2) as team_2_avg_goals,\n    max(h.match_date) as last_meeting_date,\n    l5.last_5_results\nfrom h2h_matches h\nleft join last_5_matches l5 on h.team_id_1 = l5.team_id_1 and h.team_id_2 = l5.team_id_2\ngroup by h.team_id_1, h.team_id_2, l5.last_5_results\nhaving count(*) >= 3\norder by total_matches desc, last_meeting_date desc", "relation_name": "\"dwh\".\"gold\".\"mart_head_to_head\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-04T12:30:04.512172Z", "completed_at": "2025-11-04T12:30:04.528806Z"}, {"name": "execute", "started_at": "2025-11-04T12:30:04.572429Z", "completed_at": "2025-11-04T12:30:04.787848Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3102138042449951, "adapter_response": {"_message": "SELECT 298", "code": "SELECT", "rows_affected": 298}, "message": "SELECT 298", "failures": null, "unique_id": "model.sofascore_pipeline.mart_team_discipline", "compiled": true, "compiled_code": "\n\nwith all_matches as (\n    -- Wszystkie mecze\n    select\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        fm.home_team_id as team_id,\n        fm.home_team_name as team_name,\n        fm.match_id\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    where fm.status_type = 'finished'\n    \n    union all\n    \n    select\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        fm.away_team_id as team_id,\n        fm.away_team_name as team_name,\n        fm.match_id\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    where fm.status_type = 'finished'\n),\nteam_stats as (\n    -- Statystyki dyscyplinarne (tylko gdzie dost\u0119pne)\n    select\n        ftm.team_id,\n        ftm.team_name,\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        ftm.match_id,\n        coalesce(ftm.stat_yellowcards, 0) as yellow_cards,\n        coalesce(ftm.stat_redcards, 0) as red_cards,\n        coalesce(ftm.stat_fouls, 0) as fouls,\n        coalesce(ftm.stat_offsides, 0) as offsides,\n        coalesce(ftm.stat_freekicks, 0) as free_kicks\n    from \"dwh\".\"silver\".\"fact_team_match\" ftm\n    join \"dwh\".\"silver\".\"fact_match\" fm on ftm.match_id = fm.match_id\n    where ftm.period = 'ALL'\n        and fm.status_type = 'finished'\n),\ncombined as (\n    select\n        am.season_id,\n        am.season_name,\n        am.season_year,\n        am.team_id,\n        am.team_name,\n        am.match_id,\n        coalesce(ts.yellow_cards, 0) as yellow_cards,\n        coalesce(ts.red_cards, 0) as red_cards,\n        coalesce(ts.fouls, 0) as fouls,\n        coalesce(ts.offsides, 0) as offsides,\n        coalesce(ts.free_kicks, 0) as free_kicks\n    from all_matches am\n    left join team_stats ts \n        on am.match_id = ts.match_id \n        and am.team_id = ts.team_id\n        and am.season_id = ts.season_id\n)\nselect\n    team_id,\n    team_name,\n    season_id,\n    season_name,\n    season_year,\n    count(distinct match_id) as matches_played,\n    sum(yellow_cards) as total_yellow_cards,\n    round(avg(yellow_cards), 2) as yellow_cards_per_game,\n    sum(red_cards) as total_red_cards,\n    sum(fouls) as total_fouls,\n    round(avg(fouls), 2) as fouls_per_game,\n    sum(offsides) as total_offsides,\n    round(avg(offsides), 2) as offsides_per_game,\n    sum(free_kicks) as total_free_kicks,\n    round(avg(free_kicks), 2) as free_kicks_per_game\nfrom combined\ngroup by team_id, team_name, season_id, season_name, season_year\norder by season_year desc, total_yellow_cards desc", "relation_name": "\"dwh\".\"gold\".\"mart_team_discipline\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-04T12:30:04.501874Z", "completed_at": "2025-11-04T12:30:04.521647Z"}, {"name": "execute", "started_at": "2025-11-04T12:30:04.523618Z", "completed_at": "2025-11-04T12:30:04.789840Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.31453466415405273, "adapter_response": {"_message": "SELECT 298", "code": "SELECT", "rows_affected": 298}, "message": "SELECT 298", "failures": null, "unique_id": "model.sofascore_pipeline.mart_team_attack", "compiled": true, "compiled_code": "\n\nwith all_matches as (\n    -- Wszystkie mecze z golami (niezale\u017cnie od dost\u0119pno\u015bci statystyk)\n    select\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        fm.home_team_id as team_id,\n        fm.home_team_name as team_name,\n        fm.match_id,\n        fm.home_score as goals_scored\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    where fm.status_type = 'finished'\n    \n    union all\n    \n    select\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        fm.away_team_id as team_id,\n        fm.away_team_name as team_name,\n        fm.match_id,\n        fm.away_score as goals_scored\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    where fm.status_type = 'finished'\n),\nteam_stats as (\n    -- Statystyki szczeg\u00f3\u0142owe (tylko dla mecz\u00f3w, kt\u00f3re je maj\u0105)\n    select\n        ftm.team_id,\n        ftm.team_name,\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        ftm.match_id,\n        coalesce(ftm.stat_expectedgoals, 0) as xg,\n        coalesce(ftm.stat_bigchancecreated, 0) as big_chances_created,\n        coalesce(ftm.stat_bigchancemissed, 0) as big_chances_missed,\n        coalesce(ftm.stat_bigchancescored, 0) as big_chances_scored,\n        coalesce(ftm.stat_shotsongoal, 0) as shots_on_target,\n        coalesce(ftm.stat_shotsoffgoal, 0) as shots_off_target,\n        coalesce(ftm.stat_blockedscoringattempt, 0) as blocked_shots,\n        coalesce(ftm.stat_totalshotsinsidebox, 0) as shots_inside_box,\n        coalesce(ftm.stat_totalshotsoutsidebox, 0) as shots_outside_box,\n        coalesce(ftm.stat_hitwoodwork, 0) as hit_woodwork,\n        coalesce(ftm.stat_cornerkicks, 0) as corners,\n        coalesce(ftm.stat_dribblespercentage, 0) as dribbles_success_pct,\n        coalesce(ftm.stat_touchesinoppbox, 0) as touches_in_box\n    from \"dwh\".\"silver\".\"fact_team_match\" ftm\n    join \"dwh\".\"silver\".\"fact_match\" fm on ftm.match_id = fm.match_id\n    where ftm.period = 'ALL'\n        and fm.status_type = 'finished'\n),\ncombined as (\n    -- Po\u0142\u0105cz gole ze wszystkich mecz\u00f3w + statystyki gdzie dost\u0119pne\n    select\n        am.season_id,\n        am.season_name,\n        am.season_year,\n        am.team_id,\n        am.team_name,\n        am.match_id,\n        am.goals_scored,\n        coalesce(ts.xg, 0) as xg,\n        coalesce(ts.big_chances_created, 0) as big_chances_created,\n        coalesce(ts.big_chances_missed, 0) as big_chances_missed,\n        coalesce(ts.big_chances_scored, 0) as big_chances_scored,\n        coalesce(ts.shots_on_target, 0) as shots_on_target,\n        coalesce(ts.shots_off_target, 0) as shots_off_target,\n        coalesce(ts.blocked_shots, 0) as blocked_shots,\n        coalesce(ts.shots_on_target, 0) + coalesce(ts.shots_off_target, 0) + coalesce(ts.blocked_shots, 0) as total_shots,\n        coalesce(ts.shots_inside_box, 0) as shots_inside_box,\n        coalesce(ts.shots_outside_box, 0) as shots_outside_box,\n        coalesce(ts.hit_woodwork, 0) as hit_woodwork,\n        coalesce(ts.corners, 0) as corners,\n        coalesce(ts.dribbles_success_pct, 0) as dribbles_success_pct,\n        coalesce(ts.touches_in_box, 0) as touches_in_box\n    from all_matches am\n    left join team_stats ts \n        on am.match_id = ts.match_id \n        and am.team_id = ts.team_id\n        and am.season_id = ts.season_id\n)\nselect\n    team_id,\n    team_name,\n    season_id,\n    season_name,\n    season_year,\n    count(distinct match_id) as matches_played,\n    sum(goals_scored) as total_goals,\n    round(avg(goals_scored), 2) as goals_per_game,\n    sum(xg) as total_xg,\n    round(avg(xg), 2) as xg_per_game,\n    round(sum(goals_scored) - sum(xg), 2) as xg_difference,\n    round((sum(goals_scored) - sum(xg)) / nullif(count(distinct match_id), 0), 2) as xg_diff_per_game,\n    sum(big_chances_created) as total_big_chances_created,\n    round(avg(big_chances_created), 2) as big_chances_created_per_game,\n    sum(big_chances_missed) as total_big_chances_missed,\n    round(avg(big_chances_missed), 2) as big_chances_missed_per_game,\n    sum(big_chances_scored) as total_big_chances_scored,\n    round(avg(big_chances_scored), 2) as big_chances_scored_per_game,\n    sum(shots_on_target) as total_shots_on_target,\n    round(avg(shots_on_target), 2) as shots_on_target_per_game,\n    sum(shots_off_target) as total_shots_off_target,\n    round(avg(shots_off_target), 2) as shots_off_target_per_game,\n    sum(blocked_shots) as total_blocked_shots,\n    round(avg(blocked_shots), 2) as blocked_shots_per_game,\n    sum(total_shots) as total_shots,\n    round(avg(total_shots), 2) as shots_per_game,\n    sum(shots_inside_box) as total_shots_inside_box,\n    round(avg(shots_inside_box), 2) as shots_inside_box_per_game,\n    sum(shots_outside_box) as total_shots_outside_box,\n    round(avg(shots_outside_box), 2) as shots_outside_box_per_game,\n    sum(hit_woodwork) as total_hit_woodwork,\n    sum(corners) as total_corners,\n    round(avg(corners), 2) as corners_per_game,\n    round(avg(nullif(dribbles_success_pct, 0)), 1) as avg_dribbles_success_pct,\n    sum(touches_in_box) as total_touches_in_box,\n    round(avg(touches_in_box), 2) as touches_in_box_per_game\nfrom combined\ngroup by team_id, team_name, season_id, season_name, season_year\norder by season_year desc, xg_per_game desc", "relation_name": "\"dwh\".\"gold\".\"mart_team_attack\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-04T12:30:04.507682Z", "completed_at": "2025-11-04T12:30:04.523157Z"}, {"name": "execute", "started_at": "2025-11-04T12:30:04.567408Z", "completed_at": "2025-11-04T12:30:04.791706Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.31481099128723145, "adapter_response": {"_message": "SELECT 298", "code": "SELECT", "rows_affected": 298}, "message": "SELECT 298", "failures": null, "unique_id": "model.sofascore_pipeline.mart_team_defense", "compiled": true, "compiled_code": "\n\nwith all_matches as (\n    -- Wszystkie mecze z bramkami straconymi\n    select\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        fm.home_team_id as team_id,\n        fm.home_team_name as team_name,\n        fm.match_id,\n        fm.away_score as goals_conceded,\n        case when fm.away_score = 0 then 1 else 0 end as clean_sheet\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    where fm.status_type = 'finished'\n    \n    union all\n    \n    select\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        fm.away_team_id as team_id,\n        fm.away_team_name as team_name,\n        fm.match_id,\n        fm.home_score as goals_conceded,\n        case when fm.home_score = 0 then 1 else 0 end as clean_sheet\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    where fm.status_type = 'finished'\n),\nteam_stats as (\n    -- Statystyki obronne (tylko gdzie dost\u0119pne)\n    select\n        ftm.team_id,\n        ftm.team_name,\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        ftm.match_id,\n        coalesce(ftm.stat_goalkeepersaves, 0) as goalkeeper_saves,\n        coalesce(ftm.stat_totaltackle, 0) as tackles,\n        coalesce(ftm.stat_wontacklepercent, 0) as tackles_won_pct,\n        coalesce(ftm.stat_interceptionwon, 0) as interceptions,\n        coalesce(ftm.stat_totalclearance, 0) as clearances,\n        coalesce(ftm.stat_blockedscoringattempt, 0) as blocked_shots,\n        coalesce(ftm.stat_ballrecovery, 0) as ball_recoveries,\n        coalesce(ftm.stat_aerialduelspercentage, 0) as aerial_duels_pct,\n        coalesce(ftm.stat_groundduelspercentage, 0) as ground_duels_pct,\n        coalesce(ftm.stat_duelwonpercent, 0) as duels_won_pct,\n        coalesce(ftm.stat_errorsleadtogoal, 0) as errors_lead_to_goal,\n        coalesce(ftm.stat_errorsleadtoshot, 0) as errors_lead_to_shot\n    from \"dwh\".\"silver\".\"fact_team_match\" ftm\n    join \"dwh\".\"silver\".\"fact_match\" fm on ftm.match_id = fm.match_id\n    where ftm.period = 'ALL'\n        and fm.status_type = 'finished'\n),\ncombined as (\n    select\n        am.season_id,\n        am.season_name,\n        am.season_year,\n        am.team_id,\n        am.team_name,\n        am.match_id,\n        am.goals_conceded,\n        am.clean_sheet,\n        coalesce(ts.goalkeeper_saves, 0) as goalkeeper_saves,\n        coalesce(ts.tackles, 0) as tackles,\n        coalesce(ts.tackles_won_pct, 0) as tackles_won_pct,\n        coalesce(ts.interceptions, 0) as interceptions,\n        coalesce(ts.clearances, 0) as clearances,\n        coalesce(ts.blocked_shots, 0) as blocked_shots,\n        coalesce(ts.ball_recoveries, 0) as ball_recoveries,\n        coalesce(ts.aerial_duels_pct, 0) as aerial_duels_pct,\n        coalesce(ts.ground_duels_pct, 0) as ground_duels_pct,\n        coalesce(ts.duels_won_pct, 0) as duels_won_pct,\n        coalesce(ts.errors_lead_to_goal, 0) as errors_lead_to_goal,\n        coalesce(ts.errors_lead_to_shot, 0) as errors_lead_to_shot\n    from all_matches am\n    left join team_stats ts \n        on am.match_id = ts.match_id \n        and am.team_id = ts.team_id\n        and am.season_id = ts.season_id\n)\nselect\n    team_id,\n    team_name,\n    season_id,\n    season_name,\n    season_year,\n    count(distinct match_id) as matches_played,\n    sum(goals_conceded) as total_goals_conceded,\n    round(avg(goals_conceded), 2) as goals_conceded_per_game,\n    sum(clean_sheet) as clean_sheets,\n    round(sum(clean_sheet)::numeric / count(distinct match_id)::numeric * 100, 1) as clean_sheet_pct,\n    sum(goalkeeper_saves) as total_saves,\n    round(avg(goalkeeper_saves), 2) as saves_per_game,\n    sum(tackles) as total_tackles,\n    round(avg(tackles), 2) as tackles_per_game,\n    round(avg(nullif(tackles_won_pct, 0)), 1) as avg_tackles_won_pct,\n    sum(interceptions) as total_interceptions,\n    round(avg(interceptions), 2) as interceptions_per_game,\n    sum(clearances) as total_clearances,\n    round(avg(clearances), 2) as clearances_per_game,\n    sum(blocked_shots) as total_blocked_shots,\n    round(avg(blocked_shots), 2) as blocked_shots_per_game,\n    sum(ball_recoveries) as total_ball_recoveries,\n    round(avg(ball_recoveries), 2) as ball_recoveries_per_game,\n    round(avg(nullif(aerial_duels_pct, 0)), 1) as avg_aerial_duels_pct,\n    round(avg(nullif(ground_duels_pct, 0)), 1) as avg_ground_duels_pct,\n    round(avg(nullif(duels_won_pct, 0)), 1) as avg_duels_won_pct,\n    sum(errors_lead_to_goal) as total_errors_lead_to_goal,\n    sum(errors_lead_to_shot) as total_errors_lead_to_shot\nfrom combined\ngroup by team_id, team_name, season_id, season_name, season_year\norder by season_year desc, goals_conceded_per_game asc", "relation_name": "\"dwh\".\"gold\".\"mart_team_defense\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-04T12:30:04.792613Z", "completed_at": "2025-11-04T12:30:04.811541Z"}, {"name": "execute", "started_at": "2025-11-04T12:30:04.815883Z", "completed_at": "2025-11-04T12:30:04.936234Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1607980728149414, "adapter_response": {"_message": "SELECT 298", "code": "SELECT", "rows_affected": 298}, "message": "SELECT 298", "failures": null, "unique_id": "model.sofascore_pipeline.mart_team_form", "compiled": true, "compiled_code": "\n\nwith matches as (\n    select\n        season_id,\n        season_name,\n        season_year,\n        home_team_id as team_id,\n        home_team_name as team_name,\n        match_id,\n        match_date,\n        case \n            when winner_code = 1 then 'W'\n            when winner_code = 2 then 'D'\n            when winner_code = 3 then 'L'\n        end as result,\n        case \n            when winner_code = 1 then 3\n            when winner_code = 2 then 1\n            else 0\n        end as points,\n        home_score as goals_for,\n        away_score as goals_against,\n        home_score_period1 as first_half_goals_for,\n        away_score_period1 as first_half_goals_against\n    from \"dwh\".\"silver\".\"fact_match\"\n    where status_type = 'finished'\n    \n    union all\n    \n    select\n        season_id,\n        season_name,\n        season_year,\n        away_team_id as team_id,\n        away_team_name as team_name,\n        match_id,\n        match_date,\n        case \n            when winner_code = 3 then 'W'\n            when winner_code = 2 then 'D'\n            when winner_code = 1 then 'L'\n        end as result,\n        case \n            when winner_code = 3 then 3\n            when winner_code = 2 then 1\n            else 0\n        end as points,\n        away_score as goals_for,\n        home_score as goals_against,\n        away_score_period1 as first_half_goals_for,\n        home_score_period1 as first_half_goals_against\n    from \"dwh\".\"silver\".\"fact_match\"\n    where status_type = 'finished'\n),\nlast_5_matches as (\n    select\n        m.*,\n        row_number() over (partition by team_id, season_id order by match_date desc) as match_rank\n    from matches m\n),\nform_last_5 as (\n    select\n        team_id,\n        team_name,\n        season_id,\n        season_name,\n        season_year,\n        string_agg(result, '' order by match_date desc) as last_5_results,\n        sum(points) as points_last_5,\n        sum(case when result = 'W' then 1 else 0 end) as wins_last_5,\n        sum(case when result = 'D' then 1 else 0 end) as draws_last_5,\n        sum(case when result = 'L' then 1 else 0 end) as losses_last_5,\n        sum(goals_for) as goals_for_last_5,\n        sum(goals_against) as goals_against_last_5\n    from last_5_matches\n    where match_rank <= 5\n    group by team_id, team_name, season_id, season_name, season_year\n),\nhalftime_leading as (\n    select\n        team_id,\n        season_id,\n        count(*) as halftime_leading_count,\n        sum(case when result = 'W' then 1 else 0 end) as halftime_leading_wins,\n        sum(case when result = 'D' then 1 else 0 end) as halftime_leading_draws,\n        sum(case when result = 'L' then 1 else 0 end) as halftime_leading_losses\n    from matches\n    where first_half_goals_for > first_half_goals_against\n    group by team_id, season_id\n),\nconceded_first as (\n    select\n        team_id,\n        season_id,\n        count(*) as conceded_first_count,\n        sum(points) as points_after_conceding_first\n    from matches\n    where goals_against > 0\n        and match_id in (\n            select match_id\n            from matches m2\n            where m2.team_id = matches.team_id\n                and m2.season_id = matches.season_id\n        )\n    group by team_id, season_id\n)\nselect\n    f.team_id,\n    f.team_name,\n    f.season_id,\n    f.season_name,\n    f.season_year,\n    f.last_5_results,\n    f.points_last_5,\n    f.wins_last_5,\n    f.draws_last_5,\n    f.losses_last_5,\n    f.goals_for_last_5,\n    f.goals_against_last_5,\n    h.halftime_leading_count,\n    h.halftime_leading_wins,\n    h.halftime_leading_draws,\n    h.halftime_leading_losses,\n    round(h.halftime_leading_wins::numeric / nullif(h.halftime_leading_count, 0)::numeric * 100, 1) as halftime_leading_win_pct,\n    c.conceded_first_count,\n    c.points_after_conceding_first,\n    round(c.points_after_conceding_first::numeric / nullif(c.conceded_first_count, 0)::numeric * 100 / 3, 1) as points_pct_after_conceding_first\nfrom form_last_5 f\nleft join halftime_leading h on f.team_id = h.team_id and f.season_id = h.season_id\nleft join conceded_first c on f.team_id = c.team_id and f.season_id = c.season_id\norder by f.season_year desc, f.points_last_5 desc", "relation_name": "\"dwh\".\"gold\".\"mart_team_form\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-04T12:30:04.828158Z", "completed_at": "2025-11-04T12:30:04.842116Z"}, {"name": "execute", "started_at": "2025-11-04T12:30:04.843388Z", "completed_at": "2025-11-04T12:30:04.958735Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1395430564880371, "adapter_response": {"_message": "SELECT 298", "code": "SELECT", "rows_affected": 298}, "message": "SELECT 298", "failures": null, "unique_id": "model.sofascore_pipeline.mart_team_overview", "compiled": true, "compiled_code": "\n\nwith matches as (\n    select\n        season_id,\n        season_name,\n        season_year,\n        home_team_id as team_id,\n        home_team_name as team_name,\n        match_id,\n        match_date,\n        case \n            when winner_code = 1 then 3\n            when winner_code = 3 then 1\n            when winner_code = 2 then 0\n        end as points,\n        home_score as goals_for,\n        away_score as goals_against,\n        case when winner_code = 1 then 1 else 0 end as wins,\n        case when winner_code = 3 then 1 else 0 end as draws,\n        case when winner_code = 2 then 1 else 0 end as losses,\n        case when away_score = 0 then 1 else 0 end as clean_sheets\n    from \"dwh\".\"silver\".\"fact_match\"\n    where status_type = 'finished'\n    \n    union all\n    \n    select\n        season_id,\n        season_name,\n        season_year,\n        away_team_id as team_id,\n        away_team_name as team_name,\n        match_id,\n        match_date,\n        case \n            when winner_code = 2 then 3\n            when winner_code = 3 then 1\n            when winner_code = 1 then 0\n        end as points,\n        away_score as goals_for,\n        home_score as goals_against,\n        case when winner_code = 2 then 1 else 0 end as wins,\n        case when winner_code = 3 then 1 else 0 end as draws,\n        case when winner_code = 1 then 1 else 0 end as losses,\n        case when home_score = 0 then 1 else 0 end as clean_sheets\n    from \"dwh\".\"silver\".\"fact_match\"\n    where status_type = 'finished'\n)\nselect\n    season_id,\n    season_name,\n    season_year,\n    team_id,\n    team_name,\n    count(*) as matches_played,\n    sum(wins) as wins,\n    sum(draws) as draws,\n    sum(losses) as losses,\n    sum(points) as total_points,\n    round(sum(points)::numeric / count(*)::numeric, 2) as points_per_game,\n    sum(goals_for) as goals_for,\n    sum(goals_against) as goals_against,\n    sum(goals_for) - sum(goals_against) as goal_difference,\n    round(sum(goals_for)::numeric / count(*)::numeric, 2) as goals_per_game,\n    round(sum(goals_against)::numeric / count(*)::numeric, 2) as goals_conceded_per_game,\n    sum(clean_sheets) as clean_sheets,\n    round(sum(clean_sheets)::numeric / count(*)::numeric * 100, 1) as clean_sheet_percentage\nfrom matches\ngroup by season_id, season_name, season_year, team_id, team_name\norder by season_year desc, total_points desc", "relation_name": "\"dwh\".\"gold\".\"mart_team_overview\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-04T12:30:04.832326Z", "completed_at": "2025-11-04T12:30:04.847675Z"}, {"name": "execute", "started_at": "2025-11-04T12:30:04.849512Z", "completed_at": "2025-11-04T12:30:04.984875Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16186785697937012, "adapter_response": {"_message": "SELECT 298", "code": "SELECT", "rows_affected": 298}, "message": "SELECT 298", "failures": null, "unique_id": "model.sofascore_pipeline.mart_team_possession", "compiled": true, "compiled_code": "\n\nwith all_matches as (\n    -- Wszystkie mecze\n    select\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        fm.home_team_id as team_id,\n        fm.home_team_name as team_name,\n        fm.match_id\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    where fm.status_type = 'finished'\n    \n    union all\n    \n    select\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        fm.away_team_id as team_id,\n        fm.away_team_name as team_name,\n        fm.match_id\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    where fm.status_type = 'finished'\n),\nteam_stats as (\n    -- Statystyki posiadania (tylko gdzie dost\u0119pne)\n    select\n        ftm.team_id,\n        ftm.team_name,\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        ftm.match_id,\n        coalesce(ftm.stat_ballpossession, 0) as possession_pct,\n        coalesce(ftm.stat_accuratepasses, 0) as accurate_passes,\n        coalesce(ftm.stat_passes, 0) as total_passes,\n        coalesce(ftm.stat_accuratelongballs, 0) as accurate_long_balls,\n        coalesce(ftm.stat_accuratecross, 0) as accurate_crosses,\n        coalesce(ftm.stat_finalthirdentries, 0) as final_third_entries,\n        coalesce(ftm.stat_touchesinoppbox, 0) as touches_in_box,\n        coalesce(ftm.stat_dispossessed, 0) as dispossessed,\n        coalesce(ftm.stat_throwins, 0) as throw_ins,\n        coalesce(ftm.stat_goalkicks, 0) as goal_kicks\n    from \"dwh\".\"silver\".\"fact_team_match\" ftm\n    join \"dwh\".\"silver\".\"fact_match\" fm on ftm.match_id = fm.match_id\n    where ftm.period = 'ALL'\n        and fm.status_type = 'finished'\n),\ncombined as (\n    select\n        am.season_id,\n        am.season_name,\n        am.season_year,\n        am.team_id,\n        am.team_name,\n        am.match_id,\n        coalesce(ts.possession_pct, 0) as possession_pct,\n        coalesce(ts.accurate_passes, 0) as accurate_passes,\n        coalesce(ts.total_passes, 0) as total_passes,\n        coalesce(ts.accurate_long_balls, 0) as accurate_long_balls,\n        coalesce(ts.accurate_crosses, 0) as accurate_crosses,\n        coalesce(ts.final_third_entries, 0) as final_third_entries,\n        coalesce(ts.touches_in_box, 0) as touches_in_box,\n        coalesce(ts.dispossessed, 0) as dispossessed,\n        coalesce(ts.throw_ins, 0) as throw_ins,\n        coalesce(ts.goal_kicks, 0) as goal_kicks\n    from all_matches am\n    left join team_stats ts \n        on am.match_id = ts.match_id \n        and am.team_id = ts.team_id\n        and am.season_id = ts.season_id\n)\nselect\n    team_id,\n    team_name,\n    season_id,\n    season_name,\n    season_year,\n    count(distinct match_id) as matches_played,\n    round(avg(nullif(possession_pct, 0)), 1) as avg_possession_pct,\n    sum(accurate_passes) as total_accurate_passes,\n    sum(total_passes) as total_passes,\n    round(avg(accurate_passes), 1) as accurate_passes_per_game,\n    round(avg(total_passes), 1) as total_passes_per_game,\n    round(sum(accurate_passes)::numeric / nullif(sum(total_passes), 0)::numeric * 100, 1) as pass_accuracy_pct,\n    sum(accurate_long_balls) as total_accurate_long_balls,\n    round(avg(accurate_long_balls), 2) as accurate_long_balls_per_game,\n    sum(accurate_crosses) as total_accurate_crosses,\n    round(avg(accurate_crosses), 2) as accurate_crosses_per_game,\n    sum(final_third_entries) as total_final_third_entries,\n    round(avg(final_third_entries), 2) as final_third_entries_per_game,\n    sum(touches_in_box) as total_touches_in_box,\n    round(avg(touches_in_box), 2) as touches_in_box_per_game,\n    sum(dispossessed) as total_dispossessed,\n    round(avg(dispossessed), 2) as dispossessed_per_game,\n    sum(throw_ins) as total_throw_ins,\n    round(avg(throw_ins), 2) as throw_ins_per_game,\n    sum(goal_kicks) as total_goal_kicks,\n    round(avg(goal_kicks), 2) as goal_kicks_per_game\nfrom combined\ngroup by team_id, team_name, season_id, season_name, season_year\norder by season_year desc, avg_possession_pct desc", "relation_name": "\"dwh\".\"gold\".\"mart_team_possession\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-04T12:30:04.997794Z", "completed_at": "2025-11-04T12:30:05.009175Z"}, {"name": "execute", "started_at": "2025-11-04T12:30:05.010212Z", "completed_at": "2025-11-04T12:30:05.078531Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08668684959411621, "adapter_response": {"_message": "SELECT 298", "code": "SELECT", "rows_affected": 298}, "message": "SELECT 298", "failures": null, "unique_id": "model.sofascore_pipeline.mart_team_season_summary", "compiled": true, "compiled_code": "\n\nselect\n    ov.season_id,\n    ov.season_name,\n    ov.season_year,\n    ov.team_id,\n    ov.team_name,\n    \n    -- Overall stats\n    ov.matches_played,\n    ov.wins,\n    ov.draws,\n    ov.losses,\n    ov.total_points,\n    ov.points_per_game,\n    ov.goals_for,\n    ov.goals_against,\n    ov.goal_difference,\n    ov.goals_per_game,\n    ov.goals_conceded_per_game,\n    ov.clean_sheets,\n    ov.clean_sheet_percentage,\n    \n    -- Attack stats\n    att.total_xg,\n    att.xg_per_game,\n    att.xg_difference,\n    att.xg_diff_per_game,\n    att.total_big_chances_created,\n    att.big_chances_created_per_game,\n    att.total_big_chances_missed,\n    att.big_chances_missed_per_game,\n    att.total_shots,\n    att.shots_per_game,\n    att.total_shots_on_target,\n    att.shots_on_target_per_game,\n    att.total_shots_inside_box,\n    att.shots_inside_box_per_game,\n    att.total_shots_outside_box,\n    att.shots_outside_box_per_game,\n    att.total_corners,\n    att.corners_per_game,\n    att.avg_dribbles_success_pct,\n    att.total_hit_woodwork,\n    \n    -- Defense stats\n    def.total_saves,\n    def.saves_per_game,\n    def.total_tackles,\n    def.tackles_per_game,\n    def.avg_tackles_won_pct,\n    def.total_interceptions,\n    def.interceptions_per_game,\n    def.total_clearances,\n    def.clearances_per_game,\n    def.total_blocked_shots,\n    def.blocked_shots_per_game,\n    def.total_ball_recoveries,\n    def.ball_recoveries_per_game,\n    def.avg_aerial_duels_pct,\n    def.avg_ground_duels_pct,\n    def.avg_duels_won_pct,\n    def.total_errors_lead_to_goal,\n    def.total_errors_lead_to_shot,\n    \n    -- Possession stats\n    pos.avg_possession_pct,\n    pos.total_accurate_passes,\n    pos.total_passes,\n    pos.pass_accuracy_pct,\n    pos.accurate_passes_per_game,\n    pos.total_passes_per_game,\n    pos.total_accurate_long_balls,\n    pos.accurate_long_balls_per_game,\n    pos.total_accurate_crosses,\n    pos.accurate_crosses_per_game,\n    pos.total_final_third_entries,\n    pos.final_third_entries_per_game,\n    pos.total_touches_in_box as total_touches_in_box_possession,\n    pos.touches_in_box_per_game as touches_in_box_per_game_possession,\n    pos.total_dispossessed,\n    pos.dispossessed_per_game,\n    \n    -- Discipline stats\n    dis.total_yellow_cards,\n    dis.yellow_cards_per_game,\n    dis.total_red_cards,\n    dis.total_fouls,\n    dis.fouls_per_game,\n    dis.total_offsides,\n    dis.offsides_per_game,\n    dis.total_free_kicks,\n    dis.free_kicks_per_game,\n    \n    -- Form stats\n    frm.last_5_results,\n    frm.points_last_5,\n    frm.wins_last_5,\n    frm.draws_last_5,\n    frm.losses_last_5,\n    frm.goals_for_last_5,\n    frm.goals_against_last_5,\n    frm.halftime_leading_count,\n    frm.halftime_leading_wins,\n    frm.halftime_leading_win_pct,\n    frm.conceded_first_count,\n    frm.points_after_conceding_first,\n    frm.points_pct_after_conceding_first\n\nfrom \"dwh\".\"gold\".\"mart_team_overview\" ov\nleft join \"dwh\".\"gold\".\"mart_team_attack\" att \n    on ov.team_id = att.team_id \n    and ov.season_id = att.season_id\nleft join \"dwh\".\"gold\".\"mart_team_defense\" def \n    on ov.team_id = def.team_id \n    and ov.season_id = def.season_id\nleft join \"dwh\".\"gold\".\"mart_team_possession\" pos \n    on ov.team_id = pos.team_id \n    and ov.season_id = pos.season_id\nleft join \"dwh\".\"gold\".\"mart_team_discipline\" dis \n    on ov.team_id = dis.team_id \n    and ov.season_id = dis.season_id\nleft join \"dwh\".\"gold\".\"mart_team_form\" frm \n    on ov.team_id = frm.team_id \n    and ov.season_id = frm.season_id\n\norder by ov.season_year desc, ov.total_points desc", "relation_name": "\"dwh\".\"gold\".\"mart_team_season_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-04T12:30:04.968389Z", "completed_at": "2025-11-04T12:30:04.985193Z"}, {"name": "execute", "started_at": "2025-11-04T12:30:04.987389Z", "completed_at": "2025-11-04T12:30:05.092383Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1322922706604004, "adapter_response": {"_message": "SELECT 96", "code": "SELECT", "rows_affected": 96}, "message": "SELECT 96", "failures": null, "unique_id": "model.sofascore_pipeline.mart_match_predictions", "compiled": true, "compiled_code": "\n\nwith team_home_stats as (\n    select\n        fm.season_id,\n        fm.home_team_id as team_id,\n        count(*) as home_matches,\n        avg(fm.home_score) as avg_home_goals_scored,\n        avg(fm.away_score) as avg_home_goals_conceded,\n        avg(coalesce(ftm.stat_expectedgoals, 0)) as avg_home_xg,\n        avg(coalesce(ftm.stat_shotsongoal, 0)) as avg_home_shots_on_target,\n        avg(coalesce(ftm.stat_ballpossession, 0)) as avg_home_possession,\n        sum(case when fm.winner_code = 1 then 1 else 0 end)::numeric / nullif(count(*), 0) as home_win_rate,\n        sum(case when fm.winner_code = 2 then 1 else 0 end)::numeric / nullif(count(*), 0) as home_draw_rate\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    left join \"dwh\".\"silver\".\"fact_team_match\" ftm \n        on fm.match_id = ftm.match_id \n        and fm.home_team_id = ftm.team_id \n        and ftm.period = 'ALL'\n    where fm.status_type = 'finished'\n    group by fm.season_id, fm.home_team_id\n),\nteam_away_stats as (\n    select\n        fm.season_id,\n        fm.away_team_id as team_id,\n        count(*) as away_matches,\n        avg(fm.away_score) as avg_away_goals_scored,\n        avg(fm.home_score) as avg_away_goals_conceded,\n        avg(coalesce(ftm.stat_expectedgoals, 0)) as avg_away_xg,\n        avg(coalesce(ftm.stat_shotsongoal, 0)) as avg_away_shots_on_target,\n        avg(coalesce(ftm.stat_ballpossession, 0)) as avg_away_possession,\n        sum(case when fm.winner_code = 3 then 1 else 0 end)::numeric / nullif(count(*), 0) as away_win_rate,\n        sum(case when fm.winner_code = 2 then 1 else 0 end)::numeric / nullif(count(*), 0) as away_draw_rate\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    left join \"dwh\".\"silver\".\"fact_team_match\" ftm \n        on fm.match_id = ftm.match_id \n        and fm.away_team_id = ftm.team_id \n        and ftm.period = 'ALL'\n    where fm.status_type = 'finished'\n    group by fm.season_id, fm.away_team_id\n),\nteam_form as (\n    select\n        team_id,\n        season_id,\n        points_last_5,\n        wins_last_5,\n        goals_for_last_5,\n        goals_against_last_5\n    from \"dwh\".\"gold\".\"mart_team_form\"\n),\nmatches_to_predict as (\n    select\n        fm.match_id,\n        fm.match_date,\n        fm.season_id,\n        fm.season_name,\n        fm.season_year,\n        fm.home_team_id,\n        fm.home_team_name,\n        fm.away_team_id,\n        fm.away_team_name,\n        fm.tournament_id,\n        fm.tournament_name,\n        fm.status_type,\n        fm.home_score,\n        fm.away_score,\n        fm.winner_code\n    from \"dwh\".\"silver\".\"fact_match\" fm\n    where fm.status_type = 'finished'\n        and fm.match_date >= current_date - interval '90 days'  -- Last 90 days for validation\n),\nbase_predictions as (\n    select\n        mp.match_id,\n        mp.match_date,\n        mp.season_id,\n        mp.season_name,\n        mp.season_year,\n        mp.home_team_id,\n        mp.home_team_name,\n        mp.away_team_id,\n        mp.away_team_name,\n        mp.tournament_name,\n        mp.status_type,\n        mp.home_score,\n        mp.away_score,\n        mp.winner_code,\n        \n        -- Home team features\n        coalesce(hs.avg_home_goals_scored, 0) as home_avg_goals_scored_home,\n        coalesce(hs.avg_home_goals_conceded, 0) as home_avg_goals_conceded_home,\n        coalesce(hs.avg_home_xg, 0) as home_avg_xg_home,\n        coalesce(hs.avg_home_shots_on_target, 0) as home_avg_shots_on_target_home,\n        coalesce(hs.avg_home_possession, 0) as home_avg_possession_home,\n        coalesce(hs.home_win_rate, 0) as home_win_rate_home,\n        coalesce(hs.home_draw_rate, 0) as home_draw_rate_home,\n        coalesce(hf.points_last_5, 0) as home_points_last_5,\n        coalesce(hf.wins_last_5, 0) as home_wins_last_5,\n        coalesce(hf.goals_for_last_5, 0) as home_goals_for_last_5,\n        coalesce(hf.goals_against_last_5, 0) as home_goals_against_last_5,\n        \n        -- Away team features\n        coalesce(as_.avg_away_goals_scored, 0) as away_avg_goals_scored_away,\n        coalesce(as_.avg_away_goals_conceded, 0) as away_avg_goals_conceded_away,\n        coalesce(as_.avg_away_xg, 0) as away_avg_xg_away,\n        coalesce(as_.avg_away_shots_on_target, 0) as away_avg_shots_on_target_away,\n        coalesce(as_.avg_away_possession, 0) as away_avg_possession_away,\n        coalesce(as_.away_win_rate, 0) as away_win_rate_away,\n        coalesce(as_.away_draw_rate, 0) as away_draw_rate_away,\n        coalesce(af.points_last_5, 0) as away_points_last_5,\n        coalesce(af.wins_last_5, 0) as away_wins_last_5,\n        coalesce(af.goals_for_last_5, 0) as away_goals_for_last_5,\n        coalesce(af.goals_against_last_5, 0) as away_goals_against_last_5,\n        \n        -- Raw probability components\n        coalesce(hs.home_win_rate, 0.33) as raw_home_win_rate,\n        coalesce(as_.away_win_rate, 0.33) as raw_away_win_rate,\n        coalesce(hs.home_draw_rate, 0.33) as raw_home_draw_rate,\n        coalesce(as_.away_draw_rate, 0.33) as raw_away_draw_rate\n        \n    from matches_to_predict mp\n    left join team_home_stats hs \n        on mp.home_team_id = hs.team_id \n        and mp.season_id = hs.season_id\n    left join team_away_stats as_ \n        on mp.away_team_id = as_.team_id \n        and mp.season_id = as_.season_id\n    left join team_form hf \n        on mp.home_team_id = hf.team_id \n        and mp.season_id = hf.season_id\n    left join team_form af \n        on mp.away_team_id = af.team_id \n        and mp.season_id = af.season_id\n),\nnormalized_predictions as (\n    select\n        *,\n        -- Calculate predicted goals\n        round((home_avg_goals_scored_home + away_avg_goals_conceded_away) / 2, 2) as predicted_home_goals,\n        round((away_avg_goals_scored_away + home_avg_goals_conceded_home) / 2, 2) as predicted_away_goals,\n        round((home_avg_xg_home + away_avg_xg_away) / 2, 2) as predicted_total_xg,\n        \n        -- Combine win rates and draw rates with weights\n        (raw_home_win_rate * 0.6 + (1 - raw_away_win_rate - raw_away_draw_rate) * 0.4) as combined_home_prob,\n        (raw_away_win_rate * 0.6 + (1 - raw_home_win_rate - raw_home_draw_rate) * 0.4) as combined_away_prob,\n        (raw_home_draw_rate * 0.5 + raw_away_draw_rate * 0.5) as combined_draw_prob\n    from base_predictions\n),\nfinal_normalized as (\n    select\n        *,\n        -- Normalize to ensure probabilities sum to 1\n        combined_home_prob / nullif(combined_home_prob + combined_away_prob + combined_draw_prob, 0) as norm_home_prob,\n        combined_draw_prob / nullif(combined_home_prob + combined_away_prob + combined_draw_prob, 0) as norm_draw_prob,\n        combined_away_prob / nullif(combined_home_prob + combined_away_prob + combined_draw_prob, 0) as norm_away_prob\n    from normalized_predictions\n)\nselect\n    match_id,\n    match_date,\n    season_id,\n    season_name,\n    season_year,\n    home_team_id,\n    home_team_name,\n    away_team_id,\n    away_team_name,\n    tournament_name,\n    \n    -- Home team features\n    home_avg_goals_scored_home,\n    home_avg_goals_conceded_home,\n    home_avg_xg_home,\n    home_avg_shots_on_target_home,\n    home_avg_possession_home,\n    home_win_rate_home,\n    home_points_last_5,\n    home_wins_last_5,\n    home_goals_for_last_5,\n    home_goals_against_last_5,\n    \n    -- Away team features\n    away_avg_goals_scored_away,\n    away_avg_goals_conceded_away,\n    away_avg_xg_away,\n    away_avg_shots_on_target_away,\n    away_avg_possession_away,\n    away_win_rate_away,\n    away_points_last_5,\n    away_wins_last_5,\n    away_goals_for_last_5,\n    away_goals_against_last_5,\n    \n    -- Predicted scores\n    predicted_home_goals,\n    predicted_away_goals,\n    predicted_total_xg,\n    \n    -- Match outlook\n    case\n        when norm_home_prob > norm_away_prob + 0.15 then 'HOME_FAVORITE'\n        when norm_away_prob > norm_home_prob + 0.15 then 'AWAY_FAVORITE'\n        else 'BALANCED'\n    end as match_outlook,\n    \n    -- Normalized probabilities (guaranteed to sum to 100%)\n    round(coalesce(norm_home_prob, 0.33) * 100, 1) as home_win_probability,\n    round(coalesce(norm_draw_prob, 0.33) * 100, 1) as draw_probability,\n    round(coalesce(norm_away_prob, 0.33) * 100, 1) as away_win_probability,\n    \n    -- Fair odds (inverse of probability)\n    case \n        when norm_home_prob > 0.01 then round(1 / norm_home_prob, 2)\n        else 99.99\n    end as home_win_fair_odds,\n    case \n        when norm_draw_prob > 0.01 then round(1 / norm_draw_prob, 2)\n        else 99.99\n    end as draw_fair_odds,\n    case \n        when norm_away_prob > 0.01 then round(1 / norm_away_prob, 2)\n        else 99.99\n    end as away_win_fair_odds,\n    \n    -- Actual results for validation (derived from actual scores, not winner_code)\n    home_score as actual_home_score,\n    away_score as actual_away_score,\n    case \n        when home_score > away_score then 'HOME_WIN'\n        when home_score < away_score then 'AWAY_WIN'\n        when home_score = away_score then 'DRAW'\n        else 'UNKNOWN'\n    end as actual_result,\n    \n    -- Prediction accuracy metrics (also based on actual scores)\n    case \n        when (norm_home_prob > norm_draw_prob and norm_home_prob > norm_away_prob and home_score > away_score) then true\n        when (norm_draw_prob > norm_home_prob and norm_draw_prob > norm_away_prob and home_score = away_score) then true\n        when (norm_away_prob > norm_home_prob and norm_away_prob > norm_draw_prob and home_score < away_score) then true\n        else false\n    end as prediction_correct,\n    \n    abs(predicted_home_goals - home_score) as home_goals_error,\n    abs(predicted_away_goals - away_score) as away_goals_error\n\nfrom final_normalized\norder by match_date desc", "relation_name": "\"dwh\".\"gold\".\"mart_match_predictions\"", "batch_results": null}], "elapsed_time": 0.8181688785552979, "args": {"require_nested_cumulative_type_params": false, "which": "run", "introspect": true, "state_modified_compare_more_unrendered_values": false, "macro_debugging": false, "select": ["gold.*"], "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_level_file": "debug", "log_path": "/opt/dbt/project/logs", "require_explicit_package_overrides_for_builtin_materializations": true, "exclude": [], "indirect_selection": "eager", "empty": false, "skip_nodes_if_on_run_start_fails": false, "require_generic_test_arguments_property": true, "log_format_file": "debug", "partial_parse": true, "state_modified_compare_vars": false, "static_parser": true, "print": true, "require_all_warnings_handled_by_warn_error": false, "show_resource_report": false, "strict_mode": false, "write_json": true, "defer": false, "log_file_max_bytes": 10485760, "cache_selected_only": false, "show_all_deprecations": false, "source_freshness_run_project_hooks": true, "version_check": true, "profiles_dir": "/opt/dbt/profiles", "log_level": "info", "vars": {}, "log_format": "default", "favor_state": false, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "require_yaml_configuration_for_mf_time_spines": false, "require_resource_names_without_spaces": true, "validate_macro_args": false, "use_colors": true, "invocation_command": "dbt run --select gold.* --profiles-dir /opt/dbt/profiles", "upload_to_artifacts_ingest_api": false, "send_anonymous_usage_stats": true, "use_fast_test_edges": false, "project_dir": "/opt/dbt/project", "partial_parse_file_diff": true, "printer_width": 80, "quiet": false, "use_colors_file": true}}