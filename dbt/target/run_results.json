{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-11-24T18:37:15.819282Z", "invocation_id": "985ff58b-22ed-4563-9b39-797edb789b4e", "invocation_started_at": "2025-11-24T18:37:13.959896Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-24T18:37:15.507924Z", "completed_at": "2025-11-24T18:37:15.529340Z"}, {"name": "execute", "started_at": "2025-11-24T18:37:15.531149Z", "completed_at": "2025-11-24T18:37:15.791358Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.28740596771240234, "adapter_response": {"_message": "MERGE 9", "code": "MERGE", "rows_affected": 9}, "message": "MERGE 9", "failures": null, "unique_id": "model.sofascore_pipeline.matches_full_data_incremental", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT * FROM \"dwh\".\"bronze\".\"raw_matches\"\n    WHERE data IS NOT NULL\n    \n        -- \u0141aduj tylko mecze po ostatniej dacie w docelowej tabeli\n        AND TO_TIMESTAMP((data->>'startTimestamp')::BIGINT) > (\n            SELECT COALESCE(MAX(start_timestamp), '1970-01-01'::timestamp)\n            FROM \"dwh\".\"bronze\".\"full_matches_data\"\n        )\n    \n),\n\ntransformed_matches AS (\n    SELECT\n        -- Core Match Information\n        (data->>'id')::INTEGER as match_id,\n        data->>'slug' as match_slug,\n        data->>'customId' as custom_id,\n        TO_TIMESTAMP((data->>'startTimestamp')::BIGINT) as start_timestamp,\n        \n        -- Match Status & Results\n        (data->'status'->>'code')::INTEGER as status_code,\n        data->'status'->>'type' as status_type,\n        data->'status'->>'description' as status_description,\n        (data->>'winnerCode')::INTEGER as winner_code,\n        \n        -- Scores\n        (data->'homeScore'->>'current')::INTEGER as home_score_current,\n        (data->'awayScore'->>'current')::INTEGER as away_score_current,\n        (data->'homeScore'->>'period1')::INTEGER as home_score_period1,\n        (data->'homeScore'->>'period2')::INTEGER as home_score_period2,\n        (data->'awayScore'->>'period1')::INTEGER as away_score_period1,\n        (data->'awayScore'->>'period2')::INTEGER as away_score_period2,\n        \n        -- Home Team\n        (data->'homeTeam'->>'id')::INTEGER as home_team_id,\n        data->'homeTeam'->>'name' as home_team_name,\n        data->'homeTeam'->>'slug' as home_team_slug,\n        data->'homeTeam'->>'shortName' as home_team_short_name,\n        data->'homeTeam'->>'nameCode' as home_team_name_code,\n        \n        -- Away Team\n        (data->'awayTeam'->>'id')::INTEGER as away_team_id,\n        data->'awayTeam'->>'name' as away_team_name,\n        data->'awayTeam'->>'slug' as away_team_slug,\n        data->'awayTeam'->>'shortName' as away_team_short_name,\n        data->'awayTeam'->>'nameCode' as away_team_name_code,\n        \n        -- Tournament & Season\n        (data->'tournament'->>'id')::INTEGER as tournament_id,\n        data->'tournament'->>'name' as tournament_name,\n        data->'tournament'->>'slug' as tournament_slug,\n        (data->'tournament'->'uniqueTournament'->>'id')::INTEGER as unique_tournament_id,\n        (data->'season'->>'id')::INTEGER as season_id,\n        data->'season'->>'name' as season_name,\n        data->'season'->>'year' as season_year,\n        \n        -- Country/Category\n        data->'tournament'->'category'->'country'->>'name' as country_name,\n        data->'tournament'->'category'->'country'->>'alpha2' as country_alpha2,\n        data->'tournament'->'category'->'country'->>'alpha3' as country_alpha3,\n        \n        -- Round & Time Details\n        (data->'roundInfo'->>'round')::INTEGER as round_number,\n        (data->'time'->>'injuryTime2')::INTEGER as injury_time_2,\n        CASE \n            WHEN data->'time'->>'currentPeriodStartTimestamp' IS NOT NULL \n            THEN TO_TIMESTAMP((data->'time'->>'currentPeriodStartTimestamp')::BIGINT)\n            ELSE NULL \n        END as current_period_start_timestamp,\n        \n        -- Match Flags\n        (data->>'isEditor')::BOOLEAN as is_editor,\n        (data->>'feedLocked')::BOOLEAN as feed_locked,\n        (data->>'finalResultOnly')::BOOLEAN as final_result_only,\n        (data->>'hasGlobalHighlights')::BOOLEAN as has_global_highlights,\n        \n        -- Metadata\n        data->'_metadata'->>'source' as source,\n        data->'_metadata'->>'batch_id' as batch_id,\n        (data->'_metadata'->>'ingestion_timestamp')::TIMESTAMP as ingestion_timestamp,\n        \n        -- Audit columns - nie nadpisujemy created_at, tylko updated_at\n        NULL::TIMESTAMP WITH TIME ZONE as created_at,\n        CURRENT_TIMESTAMP as updated_at\n        \n    FROM source_data\n)\n\nSELECT * FROM transformed_matches", "relation_name": "\"dwh\".\"bronze\".\"full_matches_data\"", "batch_results": null}], "elapsed_time": 0.4922468662261963, "args": {"log_level_file": "debug", "defer": false, "print": true, "log_path": "/opt/dbt/project/logs", "strict_mode": false, "require_resource_names_without_spaces": true, "upload_to_artifacts_ingest_api": false, "macro_debugging": false, "partial_parse_file_diff": true, "favor_state": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_yaml_configuration_for_mf_time_spines": false, "populate_cache": true, "require_all_warnings_handled_by_warn_error": false, "empty": false, "vars": {}, "show_all_deprecations": false, "static_parser": true, "profiles_dir": "/opt/dbt/profiles", "printer_width": 80, "partial_parse": true, "write_json": true, "version_check": true, "select": ["bronze.matches_full_data_incremental"], "skip_nodes_if_on_run_start_fails": false, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "log_level": "info", "quiet": false, "use_colors_file": true, "use_fast_test_edges": false, "cache_selected_only": false, "indirect_selection": "eager", "log_format": "default", "require_batched_execution_for_custom_microbatch_strategy": false, "exclude": [], "require_generic_test_arguments_property": true, "source_freshness_run_project_hooks": true, "log_format_file": "debug", "project_dir": "/opt/dbt/project", "require_nested_cumulative_type_params": false, "log_file_max_bytes": 10485760, "validate_macro_args": false, "send_anonymous_usage_stats": true, "introspect": true, "state_modified_compare_more_unrendered_values": false, "invocation_command": "dbt run --models bronze.matches_full_data_incremental", "show_resource_report": false, "state_modified_compare_vars": false, "which": "run"}}